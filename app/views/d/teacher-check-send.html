{% extends "layout.html" %}

{% block pageTitle %}
  Teachers' Student Loan Reimbursement
{% endblock %}

{% block beforeContent %}
  {% include "includes/phase-banner.html" %}
{% endblock %}

{% block content %}

  {% if data.applicant.full_name %}
  {% set full_name = data.applicant.full_name %}
  {% else %}
  {% set full_name = globals.smd.teacher.full_name %}
  {% endif %}

  {% set details_complete = true %}
  {% set admin_start_date = true %}
  {% set admin_end_date = true %}

  {% if not data['admin-eligibility-period'] or data['admin-eligibility-period'] == "tbc" %}
  {{ "data.admin-eligibility-period is incomplete or tbc" | log }}
  {% set details_complete = false %}
  {% endif %}

  {% if data['admin-eligibility-period'] == "yes-part" %}
  {% if not data['admin-start-day'] or not data['admin-start-month'] or not data['admin-start-year'] %}
  {{ "data.admin-eligibility-period start dates are incomplete" | log }}
  {% set admin_start_date = false %}
  {% set details_complete = false %}
  {% endif %}
  {% endif %}

  {% if data['admin-eligibility-period'] == "yes-part" %}
  {% if not data['admin-end-day'] or not data['admin-end-month'] or not data['admin-end-year'] %}
  {{ "data.admin-eligibility-period end dates are incomplete" | log }}
  {% set admin_end_date = false %}
  {% set details_complete = false %}
  {% endif %}
  {% endif %}

  {% if not data['admin-eligibility-teaching'] or data['admin-eligibility-teaching'] == "tbc" %}
  {{ "data.admin-eligibility-teaching is incomplete or tbc" | log }}
  {% set details_complete = false %}
  {% endif %}

  {% if not data['admin-loan-amount'] or data['admin-loan-details'] == 'tbc' %}
  {{ "data.admin-loan-amount is incomplete or data.admin-loan-details is tbc" | log }}
  {% set details_complete = false %}
  {% endif %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <h1 class="govuk-heading-xl">Check your answers before confirming the claim</h1>

      <form action="teacher-check-send" method="POST" role="form">
        <div class="govuk-form-group">

          <input id="teacher-check-send" name="teacher-check-send" type="hidden" value="true">

          <!-- use additional modifier class to change column widths for multiple groups of questions and answers: -->
          <!--   * `app-check-your-answers--short` for short questions -->
          <!--   * `app-check-your-answers__questions-long` for long questions -->
          <!--   * none for single group of q&a -->
          <dl class="app-check-your-answers app-check-your-answers--short">

            <div class="app-check-your-answers__contents">
              <dt class="app-check-your-answers__question">Name</dt>
              <dd class="app-check-your-answers__answer">{{ full_name | title }}</dd>
              <dd class="app-check-your-answers__change">&nbsp;</dd>
            </div>

            <div class="app-check-your-answers__contents">
              <dt class="app-check-your-answers__question">School(s)</dt>
              <dd class="app-check-your-answers__answer">
                <ul class="govuk-list">
                {% for school in data['teacher-schools'] %}
                  <li>{{ school or "{School name}" }}</li>
                {% endfor %}
                </ul>
              </dd>
              <dd class="app-check-your-answers__change">
                <button type="submit" class="button-as-link" formaction="teacher-enter-location-confirm">Change<span class="govuk-visually-hidden"> school eligibility</span></button>
              </dd>
            </div>

            <div class="app-check-your-answers__contents">
              <dt class="app-check-your-answers__question">NI Number</dt>
              {% if data['teacher-ni'] %}
              <dd class="app-check-your-answers__answer">{{ data['teacher-ni'] }}</dd>
              {% else %}
              <dd class="app-check-your-answers__answer answer-incomplete">Incomplete</dd>
              {% endif %}
              <dd class="app-check-your-answers__change">
                <button type="submit" class="button-as-link" formaction="teacher-enter-ni-number">Change<span class="govuk-visually-hidden"> NI Number</span></button>
              </dd>
            </div>

            <div class="app-check-your-answers__contents">
              <dt class="app-check-your-answers__question">TRN</dt>
              {% if data['teacher-trn'] %}
              <dd class="app-check-your-answers__answer">{{ data['teacher-trn'] }}</dd>
              {% else %}
              <dd class="app-check-your-answers__answer answer-incomplete">Incomplete</dd>
              {% endif %}
              <dd class="app-check-your-answers__change">
                <button type="submit" class="button-as-link" formaction="teacher-enter-trn">Change<span class="govuk-visually-hidden"> TRN</span></button>
              </dd>
            </div>

            <div class="app-check-your-answers__contents">
              <dt class="app-check-your-answers__question">Payment details</dt>
              {% if data['teacher-payment-method'] == "existing" %}
              <dd class="app-check-your-answers__answer">Existing bank account</dd>
              {% elseif data['teacher-payment-method'] == "other" %}
              <dd class="app-check-your-answers__answer">Other bank account:<br/>
                </dd>
              {% else %}
              <dd class="app-check-your-answers__answer answer-incomplete">Incomplete</dd>
              {% endif %}
              <dd class="app-check-your-answers__change">
                <button type="submit" class="button-as-link" formaction="teacher-payment-method">Change<span class="govuk-visually-hidden"> payment method</span></button>
              </dd>
            </div>

            <div class="app-check-your-answers__contents">
              <dt class="app-check-your-answers__question">Contact details</dt>
              {% if data['teacher-contact-method'] == "email" %}
              <dd class="app-check-your-answers__answer">By email:<br/>
                Email</dd>
              {% elseif data['teacher-contact-method'] == "mobile" %}
              <dd class="app-check-your-answers__answer">By text message:<br/>
                Number</dd>
              {% else %}
              <dd class="app-check-your-answers__answer answer-incomplete">Incomplete</dd>
              {% endif %}
              <dd class="app-check-your-answers__change">
                <button type="submit" class="button-as-link" formaction="teacher-contact-method">Change<span class="govuk-visually-hidden"> contact method</span></button>
              </dd>
            </div>

          </dl>

        </div>

      </form>

      <h2 class="govuk-heading-m">Confirm the claim</h2>
      <p>By clicking the button below you are confirming that, to the best of your knowledge, the details provided are correct.</p>
      <p class="govuk-body">
        {% if details_complete %}
        <a href="teacher-confirmation" role="button" draggable="false" class="govuk-button">Confirm and send</a>
        {% else %}
        <a href="#" role="button" draggable="false" class="govuk-button disabled-button">Confirm and send</a>
        {% endif %}
      </p>

    </div>
  </div>
{% endblock %}
